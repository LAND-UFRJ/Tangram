/*
 * Copyright (C) 1999-2009, Edmundo Albuquerque de Souza e Silva.
 *
 * This file may be distributed under the terms of the Q Public License
 * as defined by Trolltech AS of Norway and appearing in the file
 * LICENSE.QPL included in the packaging of this file.
 *
 * THIS FILE IS PROVIDED AS IS WITH NO WARRANTY OF ANY KIND, INCLUDING
 * THE WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING
 * FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
 * NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */

/*
 * T2output.java
 *
 * Created on May 10, 2002, 3:21 PM
 */

package Tangram2;
import java.util.StringTokenizer;
import java.lang.Float;

public class T2output extends javax.swing.JDialog {

    /** Creates new form T2output */
    public T2output( boolean modal, T2modelenv p) {
        super(p, modal);
        parent = p;
        initComponents();
        initComponentsManual();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jLOutput = new javax.swing.JLabel();
        jTFOutputRate = new javax.swing.JTextField();
        jBOk = new javax.swing.JButton();
        jLOutput1 = new javax.swing.JLabel();
        jTFOutput = new javax.swing.JTextField();
        jPanel1 = new javax.swing.JPanel();

        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        setTitle("Import");
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                closeDialog(evt);
            }
        });

        jLOutput.setText("Uniformization Rate:");
        jLOutput.setFont(new java.awt.Font("Dialog", 1, 10));
        getContentPane().add(jLOutput, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 80, 140, -1));

        getContentPane().add(jTFOutputRate, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 75, 230, 20));

        jBOk.setText("Ok");
        jBOk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBOkActionPerformed(evt);
            }
        });

        getContentPane().add(jBOk, new org.netbeans.lib.awtextra.AbsoluteConstraints(400, 30, -1, 20));

        jLOutput1.setText("Output Filename:");
        jLOutput1.setFont(new java.awt.Font("Dialog", 1, 10));
        getContentPane().add(jLOutput1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 35, -1, -1));

        getContentPane().add(jTFOutput, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 30, 260, 20));

        getContentPane().add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 120, -1, -1));

        pack();
    }//GEN-END:initComponents

    private void jBOkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBOkActionPerformed
        outputFilename = jTFOutput.getText();
        
        String parameter = jTFOutputRate.getText();
        // numF;
        
        try
        {
           Float numF = new Float(parameter);
           parent.uniformization_rate = numF;
        }    
        catch( Exception e){
           parent.filename_import_output = "";
//           parent.uniformization_rate = numF;

           javax.swing.JOptionPane.showMessageDialog(this, "Uniformization must be float ","Error",javax.swing.JOptionPane.ERROR_MESSAGE);
        }

        if( outputFilename.length() == 0 )
        {
           javax.swing.JOptionPane.showMessageDialog(this,"Empty Filename - Please enter a non null filename \n or leave the default filename","Error",javax.swing.JOptionPane.ERROR_MESSAGE);
        }else
        {
           System.out.println("out - " + outputFilename);
           parent.filename_import_output = outputFilename;
           parent.setEnabled( true );
           dispose();
        }

    }//GEN-LAST:event_jBOkActionPerformed

    /** Closes the dialog */
    private void closeDialog(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_closeDialog
        setVisible(false);
        dispose();
    }//GEN-LAST:event_closeDialog

   public void initComponentsManual()
   {
        outputFilename = parent.filename_import;

        String auxtk = "";
        String auxout = "";

        System.out.println( outputFilename );

        StringTokenizer sp = new StringTokenizer( outputFilename,"." );
        
        do{
            auxtk = sp.nextToken();
            System.out.println(auxout + " - \"" + auxtk +"\"" );
            if( auxtk == "markov_mtx" || ( auxtk.compareTo("markov_mtx") == 0 ) )
            {
                continue;                
            }else
            {
                auxout += auxtk + "." ;
            }
        }while( sp.hasMoreTokens() );

        auxout += "obj";
        outputFilename = auxout;

        
        jTFOutput.setText( outputFilename );
        
       
   }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBOk;
    private javax.swing.JLabel jLOutput1;
    private javax.swing.JLabel jLOutput;
    private javax.swing.JTextField jTFOutput;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JTextField jTFOutputRate;
    // End of variables declaration//GEN-END:variables

    private String outputFilename;
    public T2modelenv parent;

}
